"use strict";(self.webpackChunkgestion_masajes_v2=self.webpackChunkgestion_masajes_v2||[]).push([[289],{1289:(e,a,r)=>{r.r(a),r.d(a,{default:()=>U});var s=r(5043),t=r(3204),n=r(164),o=r(9379),i=r(5472),l=r(5967);var c=r(7257),d=r(4653),u=r(5994),g=r(5757),f=r(4057),h=r(6511),_=r(1077);f.es,h.c,_.F;function p(e){if(!e)return null;if(e instanceof i.Dc){const a=e.toDate();return(0,c.f)(a)?a:null}if(e instanceof Date)return(0,c.f)(e)?e:null;if("string"===typeof e){const a=(0,d.H)(e);return(0,c.f)(a)?a:null}const a=new Date(e);return(0,c.f)(a)?a:null}function m(e,a){const r=p(e),s=p(a);return r&&s&&(0,u.r)(r,s)}function E(e,a){const r=p(e),s=p(a);return r&&s&&(0,g.t)(r,s)}var x=r(4025);function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{ingresos:a,loading:r}=function(){const[e,a]=(0,s.useState)([]),[r,t]=(0,s.useState)(!0),[n,c]=(0,s.useState)(null);return(0,s.useEffect)(()=>{const e=(0,i.P)((0,i.rJ)(l.db,"ingresos"),(0,i.My)("fecha","desc")),r=(0,i.aQ)(e,e=>{a(e.docs.map(e=>(0,o.A)({id:e.id},e.data()))),t(!1)},e=>{console.error("Realtime error:",e),c(e),t(!1)});return()=>r()},[]),{ingresos:e,loading:r,error:n}}(),{egresos:t,loading:n}=function(){const[e,a]=(0,s.useState)([]),[r,t]=(0,s.useState)(!0),[n,c]=(0,s.useState)(null);return(0,s.useEffect)(()=>{const e=(0,i.P)((0,i.rJ)(l.db,"egresos"),(0,i.My)("fecha","desc")),r=(0,i.aQ)(e,e=>{a(e.docs.map(e=>(0,o.A)({id:e.id},e.data()))),t(!1)},e=>{console.error("Realtime error (egresos):",e),c(e),t(!1)});return()=>r()},[]),{egresos:e,loading:r,error:n}}(),c=r||n;return(0,s.useMemo)(()=>{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),1);let n,i,l,d="month";e.fecha?(d="single",n=p(e.fecha)):e.from&&e.to&&(d="range",i=p(e.from),l=p(e.to));const u=e=>{var a,r;return Number(null!==(a=null!==(r=e.total)&&void 0!==r?r:e.valor)&&void 0!==a?a:0)};let g=a,f=t;"single"===d?(g=a.filter(e=>m(p(e.fecha),n)),f=t.filter(e=>m(p(e.fecha),n)),i=n,l=n):"range"===d?(g=a.filter(e=>{const a=p(e.fecha);return a&&a>=i&&a<=l}),f=t.filter(e=>{const a=p(e.fecha);return a&&a>=i&&a<=l})):(g=a.filter(e=>E(p(e.fecha),r)),f=t.filter(e=>E(p(e.fecha),r)),i=s,l=r);const h={},_=(e,a)=>{const r=p(a.fecha).toISOString().slice(0,10);h[r]=h[r]||{ingresos:0,egresos:0},h[r][e]+=u(a)};g.forEach(e=>_("ingresos",e)),f.forEach(e=>_("egresos",e));const j=Object.entries(h).map(e=>{let[a,r]=e;return(0,o.A)({name:a},r)}).sort((e,a)=>new Date(e.name)-new Date(a.name));let S=0,v=0;const C=j.map(e=>{let{name:a,ingresos:r,egresos:s}=e;return S+=r,v+=s,{name:a,ingresos:S,egresos:v}}),N=(e,a,r)=>a.map(a=>({name:a,value:e.filter(e=>e[r]===a).reduce((e,a)=>e+u(a),0)})).filter(e=>e.value>0),I=N(g,x.N1,"tipo"),O=N(g,x.gl,"categoria"),A=N(f,x.L0,"tipo"),R=N(f,x.Q8,"categoria");return{loading:c,byDate:C,ingresosByTipo:I,ingresosByCategoria:O,egresosByTipo:A,egresosByCategoria:R}},[a,t,e.fecha,e.from,e.to,c])}var S=r(108),v=r(1474),C=r(7734),N=r(2185),I=r(760),O=r(379),A=r(95),R=r(9930);const T={chartWrapper:"Charts_chartWrapper__pvGGc",chartTitle:"Charts_chartTitle__ODGiq",chart:"Charts_chart__9gQgT",pieChart:"Charts_pieChart__r4+BY"};var D=r(579);function G(e){let{data:a}=e;return(0,D.jsx)(S.u,{width:"100%",height:300,children:(0,D.jsxs)(v.E,{data:a,className:T.chart,children:[(0,D.jsx)(C.d,{strokeDasharray:"3 3"}),(0,D.jsx)(N.W,{dataKey:"name"}),(0,D.jsx)(I.h,{}),(0,D.jsx)(O.m,{formatter:e=>(new Intl.NumberFormat).format(e)}),(0,D.jsx)(A.s,{}),(0,D.jsx)(R.y,{dataKey:"ingresos",fill:"#82ca9d",name:"Ingresos"}),(0,D.jsx)(R.y,{dataKey:"egresos",fill:"#8884d8",name:"Egresos"})]})})}var b=r(6992),B=r(6102),y=r(7869);function F(e){let{title:a,data:r}=e;const s=["#0088FE","#00C49F","#FFBB28","#FF8042","#A28EFF","#FF6E6E"];return(0,D.jsxs)("div",{className:T.pieChart,role:"region","aria-label":a,children:[(0,D.jsx)("h3",{children:a}),(0,D.jsx)(S.u,{width:"100%",height:300,children:(0,D.jsxs)(b.r,{children:[(0,D.jsx)(B.F,{data:r,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:80,label:!0,children:r.map((e,a)=>(0,D.jsx)(y.f,{fill:s[a%s.length]},"cell-".concat(a)))}),(0,D.jsx)(O.m,{formatter:e=>(new Intl.NumberFormat).format(e)}),(0,D.jsx)(A.s,{layout:"vertical",align:"right"})]})})]})}const L={container:"Graficos1_container__Kxclo",title:"Graficos1_title__Uhjlg",filterBox:"Graficos1_filterBox__mCEQO",filterRow:"Graficos1_filterRow__bcy74",filterFields:"Graficos1_filterFields__H1mQ8",fieldPair:"Graficos1_fieldPair__SywNZ",filterGroup:"Graficos1_filterGroup__MqEZp",buttonGroup:"Graficos1_buttonGroup__izPrg",filterButton:"Graficos1_filterButton__MrNf3",cards:"Graficos1_cards__SN1Dx",card:"Graficos1_card__hLErq",valueWrapper:"Graficos1_valueWrapper__L9TfI",green:"Graficos1_green__a3P20",red:"Graficos1_red__2z34w",arrow_green:"Graficos1_arrow_green__JB1vx",arrow_red:"Graficos1_arrow_red__NdI-R",barSection:"Graficos1_barSection__TACLf",axisLabels:"Graficos1_axisLabels__WF3CE",piesContainer:"Graficos1_piesContainer__9QVCX",pieBlock:"Graficos1_pieBlock__uS5dt",pieIngresos:"Graficos1_pieIngresos__wE57+",pieEgresos:"Graficos1_pieEgresos__wf2nE",pieWrapper:"Graficos1_pieWrapper__QpfiY",toggleContainer:"Graficos1_toggleContainer__E4na5",toggleButton:"Graficos1_toggleButton__gb6ih",loading:"Graficos1_loading__d74dJ"},w=e=>{const a=new Date(e),r=String(a.getDate()).padStart(2,"0"),s=String(a.getMonth()+1).padStart(2,"0"),t=a.getFullYear();return"".concat(r,"-").concat(s,"-").concat(t)};function U(){const{t:e}=(0,n.j)(),[a,r]=(0,s.useState)("single"),[o,i]=(0,s.useState)(""),[l,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(""),[g,f]=(0,s.useState)(""),[h,_]=(0,s.useState)(""),[p,m]=(0,s.useState)({}),{byDate:E,ingresosByTipo:x,egresosByTipo:S,ingresosByCategoria:v,egresosByCategoria:C,loading:N}=j(p),I=E.length?E.at(-1).ingresos:0,O=E.length?E.at(-1).egresos:0,A=I-O,R=O>0?A/O:0,T=I>0?A/I*100:0,b=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e),B=e=>e.toFixed(2),y=e=>new Intl.NumberFormat("es-AR",{style:"percent",minimumFractionDigits:1}).format(e/100),U=(0,s.useMemo)(()=>[{label:e("total_ingresos"),value:I,fmt:b,color:"green"},{label:e("total_egresos"),value:O,fmt:b,color:"red"},{label:e("utilidad"),value:A,fmt:b,color:A>=0?"green":"red"},{label:e("indice"),value:R,fmt:B,color:R>=1?"green":"red"},{label:e("margen_utilidad"),value:T,fmt:y,color:T>=0?"green":"red"}],[I,O,A,R,T,e]),[M,P]=(0,s.useState)("categoria"),J=(0,s.useMemo)(()=>E.map(e=>({name:w(e.name),ingresos:e.ingresos,egresos:e.egresos})),[E]),Q=(new Date).getFullYear(),k=Array.from({length:6},(e,a)=>Q-a);if(N)return(0,D.jsxs)("p",{className:L.loading,children:[e("cargando"),"\u2026"]});const V="categoria"===M?v:x,W="categoria"===M?C:S;return(0,D.jsxs)("div",{className:L.container,children:[(0,D.jsx)("h2",{className:L.title,children:e("panel_financiero")}),(0,D.jsxs)("div",{className:L.filterBox,children:[(0,D.jsxs)("div",{className:L.filterGroup,children:[(0,D.jsx)("label",{children:e("modo_de_filtro")}),(0,D.jsxs)("select",{value:a,onChange:e=>r(e.target.value),children:[(0,D.jsx)("option",{value:"single",children:e("una_sola_fecha")}),(0,D.jsx)("option",{value:"range",children:e("rango_de_fechas")}),(0,D.jsx)("option",{value:"mensual",children:e("mensual")})]})]}),"single"===a&&(0,D.jsxs)("div",{className:L.filterGroup,children:[(0,D.jsx)("label",{children:e("una_sola_fecha")}),(0,D.jsx)("input",{type:"date",value:o,onChange:e=>i(e.target.value)})]}),"range"===a&&(0,D.jsxs)("div",{className:L.fieldPair,children:[(0,D.jsxs)("div",{className:L.filterGroup,children:[(0,D.jsx)("label",{children:e("desde")}),(0,D.jsx)("input",{type:"date",value:l,onChange:e=>c(e.target.value)})]}),(0,D.jsxs)("div",{className:L.filterGroup,children:[(0,D.jsx)("label",{children:e("hasta")}),(0,D.jsx)("input",{type:"date",value:d,onChange:e=>u(e.target.value)})]})]}),"mensual"===a&&(0,D.jsxs)("div",{className:L.fieldPair,children:[(0,D.jsxs)("div",{className:L.filterGroup,children:[(0,D.jsx)("label",{children:e("mes")}),(0,D.jsxs)("select",{value:g,onChange:e=>f(e.target.value),children:[(0,D.jsx)("option",{value:"",children:"\u2014"}),Array.from({length:12},(e,a)=>a+1).map(e=>(0,D.jsx)("option",{value:String(e).padStart(2,"0"),children:String(e).padStart(2,"0")},e))]})]}),(0,D.jsxs)("div",{className:L.filterGroup,children:[(0,D.jsx)("label",{children:e("anio")}),(0,D.jsxs)("select",{value:h,onChange:e=>_(e.target.value),children:[(0,D.jsx)("option",{value:"",children:"\u2014"}),k.map(e=>(0,D.jsx)("option",{value:e,children:e},e))]})]})]}),(0,D.jsxs)("div",{className:L.buttonGroup,children:[(0,D.jsx)("button",{onClick:()=>{if("single"===a&&o)m({fecha:o});else if("range"===a&&l&&d)m({from:l,to:d});else if("mensual"===a&&g&&h){const e=g.padStart(2,"0"),a="".concat(h,"-").concat(e,"-01"),r=new Date(h,+g,0).toISOString().slice(0,10);m({from:a,to:r})}else m({})},className:L.filterButton,children:e("aplicar_filtro")}),(0,D.jsx)("button",{onClick:()=>{i(""),c(""),u(""),f(""),_(""),m({})},className:L.filterButton,children:e("borrar_filtro")})]})]}),(0,D.jsx)("div",{className:L.cards,children:U.map((e,a)=>{const r="green"===e.color?t.uCC:t.$TP;return(0,D.jsxs)("div",{className:L.card,children:[(0,D.jsx)("h3",{children:e.label}),(0,D.jsxs)("div",{className:L.valueWrapper,children:[(0,D.jsx)("span",{className:L[e.color],children:e.fmt(e.value)}),(0,D.jsx)(r,{className:L["arrow_".concat(e.color)]})]})]},a)})}),(0,D.jsxs)("section",{className:L.barSection,children:[(0,D.jsx)("h4",{children:e("ingresos_vs_egresos_acumulado")}),(0,D.jsx)(G,{data:J})]}),(0,D.jsx)("div",{className:L.toggleContainer,children:(0,D.jsx)("button",{onClick:()=>P(e=>"categoria"===e?"tipo":"categoria"),className:L.toggleButton,children:e("categoria"===M?"agrupado_por_tipo":"agrupado_por_categoria")})}),(0,D.jsxs)("div",{className:L.piesContainer,children:[(0,D.jsxs)("div",{className:"".concat(L.pieBlock," ").concat(L.pieIngresos),children:[(0,D.jsxs)("h5",{children:[e("ingresos_por"),"\xa0",e("categoria"===M?"categoria":"tipo")]}),(0,D.jsx)("div",{className:L.pieWrapper,children:(0,D.jsx)(F,{data:V})})]}),(0,D.jsxs)("div",{className:"".concat(L.pieBlock," ").concat(L.pieEgresos),children:[(0,D.jsxs)("h5",{children:[e("egresos_por"),"\xa0",e("categoria"===M?"categoria":"tipo")]}),(0,D.jsx)("div",{className:L.pieWrapper,children:(0,D.jsx)(F,{data:W})})]})]})]})}},4025:(e,a,r)=>{r.d(a,{FE:()=>t,L0:()=>l,N1:()=>s,Q8:()=>d,Xf:()=>o,gl:()=>i,j1:()=>c,pr:()=>n});const s=["INMUEBLE","VEHICULO","SUCURSALES","INVERSIONES","NORMA - MASAJES","OTROS"],t=["DPTO CIUDAD DE LA PAZ","DPTO CORRIENTES","DPTO CONESA I","DPTO CONESA II"],n=["PRANA","EQUILIBRIO","FOUR SEASONS","MASAJES EN DOMICILIO","MASAJES A DOMICILIO"],o=["EFECTIVO","CHEQUE","TARJETA DE CREDITO","TARJETA DE DEBITO","BILLETERA VIRTUAL","TRANSFERENCIA","ACREDITACION","OTROS"],i=["SERVICIO","ALQUILER","INVERSIONES","OTROS"],l=["INMUEBLE","VEHICULO","SUCURSALES","JUBILACION","OTROS"],c=["EFECTIVO","CHEQUE","TARJETA DE CREDITO","TARJETA DE DEBITO","BILLETERA VIRTUAL","TRANSFERENCIA","OTROS"],d=["SERVICIO","SUELDOS","PRODUCTOS DE LIMPIEZA","PRODUCTOS DE MASAJE","VEH\xcdCULO","SEGUROS","OTROS"]}}]);
//# sourceMappingURL=289.67a2709e.chunk.js.map