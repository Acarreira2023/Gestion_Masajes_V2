"use strict";(self.webpackChunkgestion_masajes_v2=self.webpackChunkgestion_masajes_v2||[]).push([[521],{1521:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var a=s(5043),n=s(164),l=s(5967),i=s(5472),c=s(3204);const r={container:"Datos_container__HCjmf",title:"Datos_title__RpB68",filterBox:"Datos_filterBox__SBGV2",filterGroup:"Datos_filterGroup__W-g0X",fieldPair:"Datos_fieldPair__-GBRY",buttonGroup:"Datos_buttonGroup__fujiR",filterButton:"Datos_filterButton__b3A-g",tableSection:"Datos_tableSection__dMacZ",actions:"Datos_actions__CdWqL",table:"Datos_table__j-lPJ",deleteBtn:"Datos_deleteBtn__48RyQ",status:"Datos_status__LDxif"};var o=s(579);function d(){const{t:e}=(0,n.j)(),[t,s]=(0,a.useState)("single"),[d,h]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[j,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[_,v]=(0,a.useState)(""),[m,b]=(0,a.useState)({}),[S,D]=(0,a.useState)([]),[N,w]=(0,a.useState)([]),[C,k]=(0,a.useState)(new Set),[y,G]=(0,a.useState)(new Set),[B,M]=(0,a.useState)(!0),[P,z]=(0,a.useState)(null),R=(new Date).getFullYear(),q=Array.from({length:6},(e,t)=>R-t);(0,a.useEffect)(()=>{!async function(){M(!0),z(null);const e=e=>{const t=new Date(e);return t.setDate(t.getDate()+1),t};function t(t){let s=(0,i.rJ)(l.db,t);const{mode:a,fecha:n,desde:c,hasta:r,mes:o,anio:d}=m;if("single"===a&&n){const t=new Date(n);s=(0,i.P)(s,(0,i._M)("fecha",">=",t),(0,i._M)("fecha","<",e(t)),(0,i.My)("fecha","desc"))}else if("range"===a&&c&&r){const t=new Date(c),a=e(r);s=(0,i.P)(s,(0,i._M)("fecha",">=",t),(0,i._M)("fecha","<",a),(0,i.My)("fecha","desc"))}else if("mensual"===a&&o&&d){const t=o.padStart(2,"0"),a=new Date("".concat(d,"-").concat(t,"-01")),n=e(new Date(d,+o,0));s=(0,i.P)(s,(0,i._M)("fecha",">=",a),(0,i._M)("fecha","<",n),(0,i.My)("fecha","desc"))}else s=(0,i.P)(s,(0,i.My)("fecha","desc"));return s}try{const[e,s]=await Promise.all([(0,i.GG)(t("ingresos")),(0,i.GG)(t("egresos"))]),a=e=>{var t,s,a,n,l,i,c;const r=e.data(),o=r.fecha,d=null!==o&&void 0!==o&&o.toDate?o.toDate():o instanceof Date?o:null!==o&&void 0!==o&&o.seconds?new Date(1e3*o.seconds):new Date(o);return{id:e.id,fecha:d.toLocaleDateString(),categoria:null!==(t=null!==(s=r.categoria)&&void 0!==s?s:r["categor\xeda"])&&void 0!==t?t:"",tipo:null!==(a=r.tipo)&&void 0!==a?a:"",proveedor:null!==(n=null!==(l=r.proveedor)&&void 0!==l?l:r.provider)&&void 0!==n?n:"",total:null!==(i=null!==(c=r.total)&&void 0!==c?c:r.valor)&&void 0!==i?i:0}};D(e.docs.map(a)),w(s.docs.map(a)),k(new Set),G(new Set)}catch(s){console.error(s),z(s.message)}finally{M(!1)}}()},[m]);const A=(e,t,s)=>{const a=new Set(t);a.has(s)?a.delete(s):a.add(s),e(a)},F=(e,t)=>{e.length&&t(t=>t.size===e.length?new Set:new Set(e.map(e=>e.id)))},H=async(e,t,s,a)=>{for(let n of t)await s(n);a(new Set)},L=async e=>{await(0,i.kd)((0,i.H9)(l.db,"ingresos",e)),D(t=>t.filter(t=>t.id!==e)),k(t=>{const s=new Set(t);return s.delete(e),s})},E=async e=>{await(0,i.kd)((0,i.H9)(l.db,"egresos",e)),w(t=>t.filter(t=>t.id!==e)),G(t=>{const s=new Set(t);return s.delete(e),s})};return B?(0,o.jsxs)("p",{className:r.status,children:[e("cargando_resumen"),"\u2026"]}):P?(0,o.jsxs)("p",{className:r.status,children:["Error: ",P]}):(0,o.jsxs)("div",{className:r.container,children:[(0,o.jsx)("h2",{className:r.title,children:e("datos")}),(0,o.jsxs)("div",{className:r.filterBox,children:[(0,o.jsxs)("div",{className:r.filterGroup,children:[(0,o.jsx)("label",{children:e("modo_de_filtro")}),(0,o.jsxs)("select",{value:t,onChange:e=>s(e.target.value),children:[(0,o.jsx)("option",{value:"single",children:e("una_sola_fecha")}),(0,o.jsx)("option",{value:"range",children:e("rango_de_fechas")}),(0,o.jsx)("option",{value:"mensual",children:e("mensual")})]})]}),"single"===t&&(0,o.jsxs)("div",{className:r.filterGroup,children:[(0,o.jsx)("label",{children:e("una_sola_fecha")}),(0,o.jsx)("input",{type:"date",value:d,onChange:e=>h(e.target.value)})]}),"range"===t&&(0,o.jsxs)("div",{className:r.fieldPair,children:[(0,o.jsxs)("div",{className:r.filterGroup,children:[(0,o.jsx)("label",{children:e("desde")}),(0,o.jsx)("input",{type:"date",value:u,onChange:e=>x(e.target.value)})]}),(0,o.jsxs)("div",{className:r.filterGroup,children:[(0,o.jsx)("label",{children:e("hasta")}),(0,o.jsx)("input",{type:"date",value:j,onChange:e=>f(e.target.value)})]})]}),"mensual"===t&&(0,o.jsxs)("div",{className:r.fieldPair,children:[(0,o.jsxs)("div",{className:r.filterGroup,children:[(0,o.jsx)("label",{children:e("mes")}),(0,o.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"\u2014"}),Array.from({length:12},(e,t)=>t+1).map(e=>(0,o.jsx)("option",{value:String(e).padStart(2,"0"),children:String(e).padStart(2,"0")},e))]})]}),(0,o.jsxs)("div",{className:r.filterGroup,children:[(0,o.jsx)("label",{children:e("anio")}),(0,o.jsxs)("select",{value:_,onChange:e=>v(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"\u2014"}),q.map(e=>(0,o.jsx)("option",{value:e,children:e},e))]})]})]}),(0,o.jsxs)("div",{className:r.buttonGroup,children:[(0,o.jsx)("button",{onClick:()=>b({mode:t,fecha:d,desde:u,hasta:j,mes:p,anio:_}),className:r.filterButton,children:e("aplicar_filtro")}),(0,o.jsx)("button",{onClick:()=>{s("single"),h(""),x(""),f(""),g(""),v(""),b({})},className:r.filterButton,children:e("borrar_filtro")})]})]}),(0,o.jsxs)("section",{className:r.tableSection,children:[(0,o.jsx)("h3",{children:e("ingresos")}),0===S.length?(0,o.jsx)("p",{children:"No se encontraron ingresos."}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:r.actions,children:[(0,o.jsx)("button",{onClick:()=>F(S,k),children:e("seleccionar_todos")}),(0,o.jsx)("button",{disabled:!C.size,onClick:()=>H(0,C,L,k),children:e("borrar_seleccionados")})]}),(0,o.jsxs)("table",{className:r.table,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:(0,o.jsx)("input",{type:"checkbox",checked:C.size===S.length,onChange:()=>F(S,k)})}),(0,o.jsx)("th",{children:e("fecha")}),(0,o.jsx)("th",{children:e("categoria")}),(0,o.jsx)("th",{children:e("tipo")}),(0,o.jsx)("th",{children:e("proveedor")}),(0,o.jsx)("th",{children:e("Total")}),(0,o.jsx)("th",{children:e("acciones")})]})}),(0,o.jsx)("tbody",{children:S.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"checkbox",checked:C.has(e.id),onChange:()=>A(k,C,e.id)})}),(0,o.jsx)("td",{children:e.fecha}),(0,o.jsx)("td",{children:e.categoria}),(0,o.jsx)("td",{children:e.tipo}),(0,o.jsx)("td",{children:e.proveedor}),(0,o.jsxs)("td",{children:["$",e.total]}),(0,o.jsx)("td",{children:(0,o.jsx)("button",{className:r.deleteBtn,onClick:()=>L(e.id),children:(0,o.jsx)(c.qbC,{})})})]},e.id))})]})]})]}),(0,o.jsxs)("section",{className:r.tableSection,children:[(0,o.jsx)("h3",{children:e("egresos")}),0===N.length?(0,o.jsx)("p",{children:"No se encontraron egresos."}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:r.actions,children:[(0,o.jsx)("button",{onClick:()=>F(N,G),children:e("seleccionar_todos")}),(0,o.jsx)("button",{disabled:!y.size,onClick:()=>H(0,y,E,G),children:e("borrar_seleccionados")})]}),(0,o.jsxs)("table",{className:r.table,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:(0,o.jsx)("input",{type:"checkbox",checked:y.size===N.length,onChange:()=>F(N,G)})}),(0,o.jsx)("th",{children:e("fecha")}),(0,o.jsx)("th",{children:e("categoria")}),(0,o.jsx)("th",{children:e("tipo")}),(0,o.jsx)("th",{children:e("proveedor")}),(0,o.jsx)("th",{children:e("Total")}),(0,o.jsx)("th",{children:e("acciones")})]})}),(0,o.jsx)("tbody",{children:N.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"checkbox",checked:y.has(e.id),onChange:()=>A(G,y,e.id)})}),(0,o.jsx)("td",{children:e.fecha}),(0,o.jsx)("td",{children:e.categoria}),(0,o.jsx)("td",{children:e.tipo}),(0,o.jsx)("td",{children:e.proveedor}),(0,o.jsxs)("td",{children:["$",e.total]}),(0,o.jsx)("td",{children:(0,o.jsx)("button",{className:r.deleteBtn,onClick:()=>E(e.id),children:(0,o.jsx)(c.qbC,{})})})]},e.id))})]})]})]})]})}}}]);
//# sourceMappingURL=521.30ecf934.chunk.js.map